/*!
 * jQuery Popup Overlay
 *
 * @version 1.7.13
 * @requires jQuery v1.7.1+
 * @link http://vast-engineering.github.com/jquery-popup-overlay/
 */
(function(e){var b=e(window);var p={};var m=[];var c=[];var k;var a=null;var g="_open";var i="_close";var l=[];var h=null;var f;var j=/(iPad|iPhone|iPod)/g.test(navigator.userAgent);var o="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]";var d={_init:function(s){var r=e(s);var q=r.data("popupoptions");c[s.id]=false;m[s.id]=0;if(!r.data("popup-initialized")){r.attr("data-popup-initialized","true");d._initonce(s)}if(q.autoopen){setTimeout(function(){d.show(s,0)},0)}},_initonce:function(r){var y=e(r);var t=e("body");var v;var z=y.data("popupoptions");var u;a=parseInt(t.css("margin-right"),10);h=document.body.style.webkitTransition!==undefined||document.body.style.MozTransition!==undefined||document.body.style.msTransition!==undefined||document.body.style.OTransition!==undefined||document.body.style.transition!==undefined;if(z.type=="tooltip"){z.background=false;z.scrolllock=false}if(z.backgroundactive){z.background=false;z.blur=false;z.scrolllock=false}if(z.scrolllock){var x;var q;if(typeof k==="undefined"){x=e('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body");q=x.children();k=q.innerWidth()-q.height(99).innerWidth();x.remove()}}if(!y.attr("id")){y.attr("id","j-popup-"+parseInt((Math.random()*100000000),10))}y.addClass("popup_content");if((z.background)&&(!e("#"+r.id+"_background").length)){t.append('<div id="'+r.id+'_background" class="popup_background"></div>');var w=e("#"+r.id+"_background");w.css({opacity:0,visibility:"hidden",backgroundColor:z.color,position:"fixed",top:0,right:0,bottom:0,left:0});if(z.setzindex&&!z.autozindex){w.css("z-index","100000")}if(z.transition){w.css("transition",z.transition)}}t.append(r);y.wrap('<div id="'+r.id+'_wrapper" class="popup_wrapper" />');v=e("#"+r.id+"_wrapper");v.css({opacity:0,visibility:"hidden",position:"absolute"});if(j){v.css("cursor","pointer")}if(z.type=="overlay"){v.css("overflow","auto")}y.css({opacity:0,visibility:"hidden",display:"inline-block"});if(z.setzindex&&!z.autozindex){v.css("z-index","100001")}if(!z.outline){y.css("outline","none")}if(z.transition){y.css("transition",z.transition);v.css("transition",z.transition)}y.attr("aria-hidden",true);if(z.type=="overlay"){y.css({textAlign:"left",position:"relative",verticalAlign:"middle"});u={position:"fixed",width:"100%",height:"100%",top:0,left:0,textAlign:"center"};if(z.backgroundactive){u.position="absolute";u.height="0";u.overflow="visible"}v.css(u);v.append('<div class="popup_align" />');e(".popup_align").css({display:"inline-block",verticalAlign:"middle",height:"100%"})}y.attr("role","dialog");var s=(z.openelement)?z.openelement:("."+r.id+g);e(s).each(function(A,B){e(B).attr("data-popup-ordinal",A);if(!B.id){e(B).attr("id","open_"+parseInt((Math.random()*100000000),10))}});if(!(y.attr("aria-labelledby")||y.attr("aria-label"))){y.attr("aria-labelledby",e(s).attr("id"))}if(z.action=="hover"){z.keepfocus=false;e(s).on("mouseenter",function(A){d.show(r,e(this).data("popup-ordinal"))});e(s).on("mouseleave",function(A){d.hide(r)})}else{e(document).on("click",s,function(B){B.preventDefault();var A=e(this).data("popup-ordinal");setTimeout(function(){d.show(r,A)},0)})}if(z.closebutton){d.addclosebutton(r)}if(z.detach){y.hide().detach()}else{v.hide()}},show:function(r,w){var A=e(r);if(A.data("popup-visible")){return}if(!A.data("popup-initialized")){d._init(r)}A.attr("data-popup-initialized","true");var s=e("body");var B=A.data("popupoptions");var v=e("#"+r.id+"_wrapper");var y=e("#"+r.id+"_background");n(r,w,B.beforeopen);c[r.id]=w;setTimeout(function(){l.push(r.id)},0);if(B.autozindex){var q=document.getElementsByTagName("*");var u=q.length;var z=0;for(var t=0;t<u;t++){var x=e(q[t]).css("z-index");if(x!=="auto"){x=parseInt(x,10);if(z<x){z=x}}}m[r.id]=z;if(B.background){if(m[r.id]>0){e("#"+r.id+"_background").css({zIndex:(m[r.id]+1)})}}if(m[r.id]>0){v.css({zIndex:(m[r.id]+2)})}}if(B.detach){v.prepend(r);A.show()}else{v.show()}f=setTimeout(function(){v.css({visibility:"visible",opacity:1});e("html").addClass("popup_visible").addClass("popup_visible_"+r.id);v.addClass("popup_wrapper_visible")},20);if(B.scrolllock){s.css("overflow","hidden");if(s.height()>b.height()){s.css("margin-right",a+k)}}if(B.backgroundactive){A.css({top:(b.height()-(A.get(0).offsetHeight+parseInt(A.css("margin-top"),10)+parseInt(A.css("margin-bottom"),10)))/2+"px"})}A.css({visibility:"visible",opacity:1});if(B.background){y.css({visibility:"visible",opacity:B.opacity});setTimeout(function(){y.css({opacity:B.opacity})},0)}A.data("popup-visible",true);d.reposition(r,w);A.data("focusedelementbeforepopup",document.activeElement);if(B.keepfocus){A.attr("tabindex",-1);setTimeout(function(){if(B.focuselement==="closebutton"){e("#"+r.id+" ."+r.id+i+":first").focus()}else{if(B.focuselement){e(B.focuselement).focus()}else{A.focus()}}},B.focusdelay)}e(B.pagecontainer).attr("aria-hidden",true);A.attr("aria-hidden",false);n(r,w,B.onopen);if(h){v.one("transitionend",function(){n(r,w,B.opentransitionend)})}else{n(r,w,B.opentransitionend)}if(B.type=="tooltip"){e(window).on("resize."+r.id,function(){d.reposition(r,w)})}},hide:function(u,x){var t=e.inArray(u.id,l);if(t===-1){return}if(f){clearTimeout(f)}var w=e("body");var s=e(u);var r=s.data("popupoptions");var v=e("#"+u.id+"_wrapper");var q=e("#"+u.id+"_background");s.data("popup-visible",false);if(l.length===1){e("html").removeClass("popup_visible").removeClass("popup_visible_"+u.id)}else{if(e("html").hasClass("popup_visible_"+u.id)){e("html").removeClass("popup_visible_"+u.id)}}l.splice(t,1);if(v.hasClass("popup_wrapper_visible")){v.removeClass("popup_wrapper_visible")}if(r.keepfocus&&!x){setTimeout(function(){if(e(s.data("focusedelementbeforepopup")).is(":visible")){s.data("focusedelementbeforepopup").focus()}},0)}v.css({visibility:"hidden",opacity:0});s.css({visibility:"hidden",opacity:0});if(r.background){q.css({visibility:"hidden",opacity:0})}e(r.pagecontainer).attr("aria-hidden",false);s.attr("aria-hidden",true);n(u,c[u.id],r.onclose);if(h&&s.css("transition-duration")!=="0s"){s.one("transitionend",function(y){if(!(s.data("popup-visible"))){if(r.detach){s.hide().detach()}else{v.hide()}}if(r.scrolllock){setTimeout(function(){w.css({overflow:"visible","margin-right":a})},10)}n(u,c[u.id],r.closetransitionend)})}else{if(r.detach){s.hide().detach()}else{v.hide()}if(r.scrolllock){setTimeout(function(){w.css({overflow:"visible","margin-right":a})},10)}n(u,c[u.id],r.closetransitionend)}if(r.type=="tooltip"){e(window).off("resize."+u.id)}},toggle:function(r,q){if(e(r).data("popup-visible")){d.hide(r)}else{setTimeout(function(){d.show(r,q)},0)}},reposition:function(u,q){var t=e(u);var s=t.data("popupoptions");var v=e("#"+u.id+"_wrapper");var r=e("#"+u.id+"_background");q=q||0;if(s.type=="tooltip"){v.css({position:"absolute"});var w;if(s.tooltipanchor){w=e(s.tooltipanchor)}else{if(s.openelement){w=e(s.openelement).filter('[data-popup-ordinal="'+q+'"]')}else{w=e("."+u.id+g+'[data-popup-ordinal="'+q+'"]')}}var x=w.offset();if(s.horizontal=="right"){v.css("left",x.left+w.outerWidth()+s.offsetleft)}else{if(s.horizontal=="leftedge"){v.css("left",x.left+w.outerWidth()-w.outerWidth()+s.offsetleft)}else{if(s.horizontal=="left"){v.css("right",b.width()-x.left-s.offsetleft)}else{if(s.horizontal=="rightedge"){v.css("right",b.width()-x.left-w.outerWidth()-s.offsetleft)}else{v.css("left",x.left+(w.outerWidth()/2)-(t.outerWidth()/2)-parseFloat(t.css("marginLeft"))+s.offsetleft)}}}}if(s.vertical=="bottom"){v.css("top",x.top+w.outerHeight()+s.offsettop)}else{if(s.vertical=="bottomedge"){v.css("top",x.top+w.outerHeight()-t.outerHeight()+s.offsettop)}else{if(s.vertical=="top"){v.css("bottom",b.height()-x.top-s.offsettop)}else{if(s.vertical=="topedge"){v.css("bottom",b.height()-x.top-t.outerHeight()-s.offsettop)}else{v.css("top",x.top+(w.outerHeight()/2)-(t.outerHeight()/2)-parseFloat(t.css("marginTop"))+s.offsettop)}}}}}else{if(s.type=="overlay"){if(s.horizontal){v.css("text-align",s.horizontal)}else{v.css("text-align","center")}if(s.vertical){t.css("vertical-align",s.vertical)}else{t.css("vertical-align","middle")}}}},addclosebutton:function(r){var q;if(e(r).data("popupoptions").closebuttonmarkup){q=e(p.closebuttonmarkup).addClass(r.id+"_close")}else{q='<button class="popup_close '+r.id+'_close" title="Close" aria-label="Close"><span aria-hidden="true">Ã—</span></button>'}if(e(r).data("popup-initialized")){e(r).append(q)}}};var n=function(t,q,u){var s=e(t).data("popupoptions");var r;var v;if(typeof s==="undefined"){return}r=s.openelement?s.openelement:("."+t.id+g);v=e(r+'[data-popup-ordinal="'+q+'"]');if(typeof u=="function"){u.call(e(t),t,v)}};e(document).on("keydown",function(s){if(l.length){var q=l[l.length-1];var r=document.getElementById(q);if(e(r).data("popupoptions").escape&&s.keyCode==27){d.hide(r)}}});e(document).on("click",function(t){if(l.length){var r=l[l.length-1];var s=document.getElementById(r);var q=(e(s).data("popupoptions").closeelement)?e(s).data("popupoptions").closeelement:("."+s.id+i);if(e(t.target).closest(q).length){t.preventDefault();d.hide(s)}if(e(s).data("popupoptions")&&e(s).data("popupoptions").blur&&!e(t.target).closest("#"+r).length&&t.which!==2&&e(t.target).is(":visible")){if(e(s).data("popupoptions").background){d.hide(s);t.preventDefault()}else{d.hide(s,true)}}}});e(document).on("keydown",function(u){if(l.length&&u.which==9){var q=l[l.length-1];var t=document.getElementById(q);var s=e(t).find("*");var v=s.filter(o).filter(":visible");var r=e(":focus");var x=v.length;var w=v.index(r);if(x===0){e(t).focus();u.preventDefault()}else{if(u.shiftKey){if(w===0){v.get(x-1).focus();u.preventDefault()}}else{if(w==x-1){v.get(0).focus();u.preventDefault()}}}}});e.fn.popup=function(q){return this.each(function(){var s=e(this);if(typeof q==="object"){var r=e.extend({},e.fn.popup.defaults,s.data("popupoptions"),q);s.data("popupoptions",r);p=s.data("popupoptions");d._init(this)}else{if(typeof q==="string"){if(!(s.data("popupoptions"))){s.data("popupoptions",e.fn.popup.defaults);p=s.data("popupoptions")}d[q].call(this,this)}else{if(!(s.data("popupoptions"))){s.data("popupoptions",e.fn.popup.defaults);p=s.data("popupoptions")}d._init(this)}}})};e.fn.popup.defaults={type:"overlay",autoopen:false,background:true,backgroundactive:false,color:"black",opacity:"0.5",horizontal:"center",vertical:"middle",offsettop:0,offsetleft:0,escape:true,blur:true,setzindex:true,autozindex:false,scrolllock:false,closebutton:false,closebuttonmarkup:null,keepfocus:true,focuselement:null,focusdelay:50,outline:false,pagecontainer:null,detach:false,openelement:null,closeelement:null,transition:null,tooltipanchor:null,beforeopen:null,onclose:null,onopen:null,opentransitionend:null,closetransitionend:null}})(jQuery);